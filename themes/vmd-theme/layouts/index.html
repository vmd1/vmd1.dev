{{ define "main" }}
        <!-- About Me Section -->
        <section class="mb-12 card card">
            <h2 class="text-2xl font-semibold mb-4 text-gray-100">Hi!</h2>
            <div class="space-y-4 text-gray-400 leading-relaxed">
            <p>I'm Vivaan, a student who‚Äôs super into programming, security, and breaking things (ethically, of course üòÖ). This is my portfolio page where I dump my projects, write-ups, and blog posts about what I‚Äôm learning along the way.</p>
            <p>Right now, I‚Äôm working on a few open-source projects - mostly related to security tools and automation. I love digging into code, figuring out how stuff works under the hood, and then building (or breaking) things just to see what happens. Every bug, every fix, every ‚Äúoh no why is this broken‚Äù moment makes me better.</p>
            <p>Outside of coding, I‚Äôm into gaming, reading, and working with A/V + Lighting setups. I‚Äôm always looking for ways to challenge myself and pick up new skills, whether that‚Äôs learning a new programming language, exploring cybersecurity challenges, or contributing to communities online.</p>
            <p>This page will keep growing as I add more projects, write more blog posts, and (hopefully) ship some cool stuff that others find useful. Feel free to check out my socials/blog through the links above and reach out if you wanna chat or collab.</p>
            </div>
        </section>

        <!-- Blog Section -->
        <section class="mb-12 card static-card">
            <h2 class="text-2xl font-semibold mb-4 text-gray-100">Latest Posts</h2>
            <div id="blog-posts" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                {{ $posts := where .Site.RegularPages "Section" "ne" "" }}
                {{ range first 6 $posts }}
                <div class="group relative h-full">
                    <a href="{{ .RelPermalink }}" class="block p-6 bg-slate-900 rounded-lg hover:bg-slate-800 transition-colors duration-200 card h-full">
                        <h3 class="text-xl font-bold text-gray-100 mb-2">{{ .Title }}</h3>
                        <p class="text-gray-400 text-truncate-4">{{ .Summary | truncate 120 }}</p>
                    </a>
                    <div class="absolute top-full left-0 right-0 mt-0 bg-slate-800 rounded-b-lg px-6 py-4 opacity-0 translate-y-2 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300 pointer-events-none group-hover:pointer-events-auto z-10 shadow-lg max-h-96 overflow-y-auto">
                        <div class="space-y-4">
                            {{ if in .Content "<h" }}
                            <div>
                                <h4 class="text-xs font-semibold text-gray-200 mb-2 uppercase">Contents</h4>
                                <nav class="text-xs text-gray-400 space-y-1">
                                    {{ range $key, $item := findRE `<li><a href="[^"]*"[^>]*>([^<]*)</a>` .TableOfContents 3 }}
                                        <div class="truncate hover:text-gray-200 transition-colors">{{ $item | replaceRE `<[^>]*>` "" }}</div>
                                    {{ end }}
                                </nav>
                            </div>
                            {{ end }}
                            <div class="space-y-2 pt-2 border-t border-slate-700">
                                <div class="text-xs text-gray-400 flex items-center gap-4">
                                    <span>{{ len (split .Content " ") }} words</span>
                                    <span>{{ .ReadingTime }} min read</span>
                                </div>
                                {{ if .Params.tags }}
                                <div class="flex flex-wrap gap-2">
                                    {{ range .Params.tags }}
                                    <span class="inline-block bg-slate-700 rounded px-2 py-1 text-xs text-gray-300">{{ . }}</span>
                                    {{ end }}
                                </div>
                                {{ end }}
                            </div>
                        </div>
                    </div>
                </div>
                {{ end }}
            </div>
            <div class="text-right mt-4">
                <a href="{{ "posts" | relURL }}" class="inline-flex items-center gap-1 text-gray-400 hover:text-gray-100 transition-colors duration-200">
                    Show all
                    <i class="ri-arrow-right-line text-lg align-middle"></i>
                </a>
            </div>

        </section>

        <!-- Featured Projects Section -->
        <section class="card static-card">
            <h2 class="text-2xl font-semibold mb-4 text-gray-100">Featured Projects</h2>
            <div id="featured-projects" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Loading spinner -->
                <div id="projects-loading" class="col-span-1 md:col-span-2 flex justify-center py-8">
                    <div class="flex flex-col items-center gap-4">
                        <div class="w-12 h-12 border-4 border-gray-700 border-t-gray-100 rounded-full animate-spin"></div>
                        <p class="text-gray-400">Loading projects...</p>
                    </div>
                </div>
            </div>
            <div class="text-right mt-4">
                <button id="show-all-projects" class="inline-flex items-center gap-1 text-gray-400 hover:text-gray-100 transition-colors duration-200">
                    Show all
                    <i class="ri-arrow-right-line text-lg align-middle"></i>
                </button>
            </div>
            <!-- Remix Icon CDN -->
            <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
        </section>

        <script>
        // Fetch and display featured projects
        async function fetchFeaturedProjects() {
            const container = document.getElementById('featured-projects');
            const username = 'vmd1';

            // 3D card tilt effect function (inline)
            function applyTilt(card) {
                card.addEventListener('mousemove', (e) => {
                    const rect = card.getBoundingClientRect();
                    const x = e.clientX - rect.left;
                    const y = e.clientY - rect.top;
                    const { width, height } = rect;
                    
                    const rotateX = (y / height - 0.5) * -20; // Max rotation 10 degrees
                    const rotateY = (x / width - 0.5) * 20;  // Max rotation 10 degrees

                    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
                });

                card.addEventListener('mouseleave', () => {
                    card.style.transform = 'perspective(1000px) rotateX(0) rotateY(0)';
                });
            }

            try {
                const [ownedResponse, starredResponse] = await Promise.all([
                    fetch(`https://api.github.com/users/${username}/repos?sort=pushed&per_page=100`),
                    fetch(`https://api.github.com/users/${username}/starred?per_page=100`)
                ]);

                const ownedRepos = await ownedResponse.json();
                const starredRepos = await starredResponse.json();

                // Get the set of starred repo IDs for quick lookup
                const starredIds = new Set(starredRepos.map(repo => repo.id));

                // Filter owned repos to only those that are also starred
                const bothOwnedAndStarred = ownedRepos.filter(repo => starredIds.has(repo.id));

                let projectsHtml = '';
                bothOwnedAndStarred.forEach(repo => {
                    projectsHtml += `
                        <div class="group relative h-full">
                            <a href="${repo.html_url}" target="_blank" rel="noopener noreferrer" class="block p-6 bg-slate-900 rounded-lg hover:bg-slate-800 transition-colors duration-200 card h-full">
                                <h3 class="text-xl font-bold text-gray-100 mb-2">${repo.full_name}</h3>
                                <p class="text-gray-400">${repo.description || 'No description available.'}</p>
                            </a>
                            <div class="absolute top-full left-0 right-0 mt-0 bg-slate-800 rounded-b-lg px-6 py-4 opacity-0 translate-y-2 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300 pointer-events-none group-hover:pointer-events-auto z-10 shadow-lg">
                                <div class="space-y-3">
                                    <div class="grid grid-cols-2 gap-4 text-xs text-gray-400">
                                        <div>
                                            <span class="text-gray-300 font-semibold">‚≠ê ${repo.stargazers_count}</span>
                                            <p class="text-gray-500">Stars</p>
                                        </div>
                                        <div>
                                            <span class="text-gray-300 font-semibold">${repo.language || 'N/A'}</span>
                                            <p class="text-gray-500">Language</p>
                                        </div>
                                        <div>
                                            <span class="text-gray-300 font-semibold">${new Date(repo.pushed_at).toLocaleDateString()}</span>
                                            <p class="text-gray-500">Last Commit</p>
                                        </div>
                                        <div>
                                            <span class="text-gray-300 font-semibold">${repo.forks_count}</span>
                                            <p class="text-gray-500">Forks</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                });
                container.innerHTML = projectsHtml;

                // Hide loading spinner and apply tilt effect to newly added cards
                document.getElementById('projects-loading').style.display = 'none';
                const newCards = container.querySelectorAll('.card');
                newCards.forEach(card => {
                    applyTilt(card);
                });
            } catch (error) {
                console.error('Error fetching featured projects:', error);
                document.getElementById('projects-loading').style.display = 'none';
                container.innerHTML = '<p class="text-gray-500">Failed to load featured projects.</p>';
            }
        }

        fetchFeaturedProjects();
        </script>
{{ end }}
